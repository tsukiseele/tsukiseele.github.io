import{o as m,c,j as u,a as _,F as v,r as $,b as p,_ as y,w as f,t as b,m as x,k as w}from"./entry.a85023df.js";import{_ as z}from"./index.23215063.js";import{_ as S}from"./client-only.fc30fa79.js";const W={class:"simple-waterfall"},C={class:"list"},T=["onClick"];function k(e,i,t,r,n,o){const a=z;return m(),c("div",W,[u(e.$slots,"header",{},void 0,!0),_("div",C,[(m(!0),c(v,null,$(t.items,(s,l)=>(m(),c("div",{class:"list-item",key:l,onClick:h=>e.$emit("click",s)},[p(a,{class:"list-item--image",src:t.imageKey?s[t.imageKey]:s.src},null,8,["src"]),u(e.$slots,"default",{index:l,item:s},void 0,!0)],8,T))),128))]),u(e.$slots,"footer",{},void 0,!0)])}const I={props:{items:{type:Array,default:()=>[]},imageKey:{type:String,default:null},itemWidth:{type:Number,default:250},gap:{type:Number,default:20},evenly:{type:Boolean,default:!1},maxColumn:{type:Number,default:null},height:{type:Number|String,default:null}},data:()=>({column:null,resizeObserver:null,resizeTimer:null}),watch:{async items(){this.$emit("load"),await this.getImageSize(),this.fall(),this.$emit("loaded")}},methods:{responsive(){this.$el&&this.fall()},fall(){const e=this.$el.offsetWidth;this.column=Math.floor((e-this.gap)/(this.itemWidth+this.gap)),this.column=this.maxColumn&&this.column>this.maxColumn?this.maxColumn:this.column||1;const i=this.evenly?(e-this.itemWidth*this.column)/(this.column+1):this.gap,t=this.evenly?i:(e-(this.itemWidth+i)*this.column+i)/2,r=this.$el.querySelectorAll(".list-item"),n=[];let o,a;r.forEach((s,l)=>{s.style.width=this.itemWidth+"px",s.style.height=this.items[l]._height;const h=s.offsetHeight;if(l<this.column)o=(this.itemWidth+i)*l+t,a=0,n.push(h);else{const d=Math.min(...n),g=n.indexOf(d);o=(this.itemWidth+i)*g+t,a=d+i,n[g]=d+i+h}s.style.left=o+"px",s.style.top=a+"px"}),this.$el.style.height=this.height?this.height:Math.max(...n)+"px"},async getImageSize(){await Promise.allSettled(this.items.map(e=>new Promise(i=>{const t=new Image;t.src=this.imageKey?e[this.imageKey]:e.src,t.onload=t.onerror=r=>{t.width>0&&t.height>0&&(e._height=t.height),i({width:t.width,height:t.height})}})))},listenLayoutChanged(){this.resizeObserver=new ResizeObserver(e=>{e&&e.length&&(this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.responsive(),clearTimeout(this.resizeTimer),this.resizeTimer=null},500))}),this.resizeObserver.observe(this.$el)}},mounted(){this.$nextTick(async()=>{await this.getImageSize(),this.fall()}),this.listenLayoutChanged()},beforeDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()}},O=y(I,[["render",k],["__scopeId","data-v-114840ac"]]),K={class:"card",id:"gallery"},M={class:"gallery-list"};function N(e,i,t,r,n,o){const a=O,s=S;return m(),c("div",K,[_("div",M,[p(s,null,{default:f(()=>[p(a,{items:e.images,imageKey:"url",itemWidth:e.isMobile?170:240,gap:e.isMobile?10:20,evenly:""},{default:f(({index:l,item:h})=>[_("span",null,b(h.title),1)]),_:1},8,["items","itemWidth","gap"])]),_:1})])])}const A={data:()=>({banner:{title:"相册",cover:null},imgsArr:[]}),computed:{...x(["images"]),...w(["isMobile"])},methods:{onItemClick(e){this.banner.cover=e.value.url}},async fetch({store:e,params:i}){await e.dispatch("images")},mounted(){}},F=y(A,[["render",N],["__scopeId","data-v-46d173b1"]]);export{F as default};
